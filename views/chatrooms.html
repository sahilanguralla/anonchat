<!DOCTYPE html>
<html>
<head>
    <!-- Standard Meta -->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  <!-- Site Properities -->
  <title>Chat Room | AnonChat - Vendetta's Chat Engine</title>

  <meta name="description" content="A Multiroom Chat Server based on JS Frameworks" />
  <meta name="keywords" content="html5, ui, library, framework, javascript" />
    
  <script type="text/javascript">
  (function () {
    var
      eventSupport = ('querySelector' in document && 'addEventListener' in window)
      jsonSupport  = (typeof JSON !== 'undefined'),
      jQuery       = (eventSupport && jsonSupport)
        ? '/js/library/jquery.min.js'
        : '/js/library/jquery.legacy.min.js'
    ;
    document.write('<script src="' + jQuery + '"><\/script>');
  }());
  </script>

  <script src="../js/semantic.min.js"></script>
  <script src="../socket.io/socket.io.js"></script>
  <script type="text/javascript">
    $(function() {
      var host = '{{config.host}}';
      var socket = io.connect(host + '/roomlist');

      socket.on('connect', function() {
        console.log('Connected to Server');
      });

      $("#create").on("click", function() {
        var room_name = $('#room-name');
        if('' != room_name) {
          socket.emit("new_room", {room_name: room_name.val()});
          room_name.val("");
        }
      });
      $("#room-name").keydown(function(e) {
        if("Enter" == e.key) {
          $('#create').click();
        }
      });

      socket.on("room_update", function(data) {
        var rooms = JSON.parse(data);
        $("#room-list").empty();
        $.each(rooms, function() {
          var str = '<div class="item"><i class="ui avatar image comments outline icon"></i><div class="content"><a href="room/' + this.room_number + '" class="header">' + this.room_name + '</a></div></div>';
          $("#room-list").prepend(str);
        });
      })
    });
  </script>
  <link rel="stylesheet" type="text/css" class="ui" href="../css/semantic.min.css">

  <link rel="stylesheet" type="text/css" href="../css/custom.css">
</head>
<body>
  <div class="container margin-top-5">
    <div class="ui centered page grid">
      <div class="six wide column">
        <div class="ui pilled segment">
          <div class="ui vertical segment">
            <h1 class="ui header">
              <i class="comments icon"></i>
              <div class="content">
                AnonChat
              </div>
            </h1>
          </div>
          <div class="ui vertical segment">
            <div class="ui horizontal segment">
              <h3 class="ui header">
                <img src="{{ user.profilePic }}" class="ui circular image">
                {{ user.fullName }}
                <div class="large ui button right floated">
                  Logout
                </div>
              </h3>
            </div>
          </div>
          <div class="ui vertical segment one column grid">
            <div class="one column row">
              <div class="column">
                <div class="ui fluid action input">
                  <input id="room-name" placeholder="a new chat room..." type="text">
                  <button id="create" class="ui teal right labeled icon button">
                    <i class="plus icon"></i>
                    Create
                  </button>
                </div>
              </div>
            </div>
            <div class="column">
              <div class="ui segment">
                <div id="room-list" class="ui very relaxed divided list">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>